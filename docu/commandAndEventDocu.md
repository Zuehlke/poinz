# Poinz Command and Event Docu
This is an autogenerated docu. 9/17/2021, 6:46:34 PM

## Commands

 * [addStory](#addStory)
 * [changeStory](#changeStory)
 * [clearStoryEstimate](#clearStoryEstimate)
 * [deleteStory](#deleteStory)
 * [giveStoryEstimate](#giveStoryEstimate)
 * [importStories](#importStories)
 * [joinRoom](#joinRoom)
 * [kick](#kick)
 * [leaveRoom](#leaveRoom)
 * [newEstimationRound](#newEstimationRound)
 * [restoreStory](#restoreStory)
 * [reveal](#reveal)
 * [selectStory](#selectStory)
 * [setAvatar](#setAvatar)
 * [setCardConfig](#setCardConfig)
 * [setEmail](#setEmail)
 * [setPassword](#setPassword)
 * [setUsername](#setUsername)
 * [settleEstimation](#settleEstimation)
 * [toggleAutoReveal](#toggleAutoReveal)
 * [toggleExclude](#toggleExclude)
 * [trashStory](#trashStory)


### Command "addStory" <a name="addStory"></a>

Source: [/server/src/commandHandlers/addStory.js](/server/src/commandHandlers/addStory.js)

Description

```text
A user adds a story to the estimation backlog of the room
```

Produces: **[storyAdded](#storyAdded)**, **[storySelected](#storySelected)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "title": {
                            "type": "string",
                            "minLength": 1,
                            "maxLength": 100
                        },
                        "description": {
                            "type": "string",
                            "minLength": 0,
                            "maxLength": 2000
                        }
                    },
                    "required": [
                        "title"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "changeStory" <a name="changeStory"></a>

Source: [/server/src/commandHandlers/changeStory.js](/server/src/commandHandlers/changeStory.js)

Description

```text
A user changes the title and/or description of a story
```

Produces: **[storyChanged](#storyChanged)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string"
                        },
                        "title": {
                            "type": "string",
                            "minLength": 1,
                            "maxLength": 100
                        },
                        "description": {
                            "type": "string",
                            "minLength": 0,
                            "maxLength": 2000
                        }
                    },
                    "required": [
                        "title",
                        "description",
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "clearStoryEstimate" <a name="clearStoryEstimate"></a>

Source: [/server/src/commandHandlers/clearStoryEstimate.js](/server/src/commandHandlers/clearStoryEstimate.js)

Description

```text
A user clears his estimation value for a certain story.
Users may only clear estimation for the currently selected story.
```

Produces: **[storyEstimateCleared](#storyEstimateCleared)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "deleteStory" <a name="deleteStory"></a>

Source: [/server/src/commandHandlers/deleteStory.js](/server/src/commandHandlers/deleteStory.js)

Description

```text
A user deletes a story.
A story must be first marked as "trashed", before it can be deleted.
Story will be completely removed from room.
```

Produces: **[storyDeleted](#storyDeleted)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuidv4"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "giveStoryEstimate" <a name="giveStoryEstimate"></a>

Source: [/server/src/commandHandlers/giveStoryEstimate.js](/server/src/commandHandlers/giveStoryEstimate.js)

Description

```text
A user gives his estimation for a certain story.
Users may only give estimations for the currently selected story.
A user that is marked as excluded (see toggleExclude/excludedFromEstimations)  cannot give estimations
As soon as all users (that can estimate) estimated the story, a "revealed" event is produced
```

Produces: **[consensusAchieved](#consensusAchieved)**, **[revealed](#revealed)**, **[storyEstimateGiven](#storyEstimateGiven)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        },
                        "value": {
                            "type": "number"
                        }
                    },
                    "required": [
                        "storyId",
                        "value"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "importStories" <a name="importStories"></a>

Source: [/server/src/commandHandlers/importStories.js](/server/src/commandHandlers/importStories.js)

Description

```text
A user wants to import multiple stories.
payload.data is expected to be a base64 encoded "data url" (something like   data:text/csv;base64,U3VtbWFyeSxJc3N1ZSBrZXksSXNzdW.......   )
Will trigger "storyAdded" events for all successfully parsed stories
Will trigger "storySelected" event, if no story is selected
```

Produces: **[importFailed](#importFailed)**, **[storyAdded](#storyAdded)**, **[storySelected](#storySelected)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "data": {
                            "type": "string",
                            "format": "csvDataUrl"
                        }
                    },
                    "required": [
                        "data"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "joinRoom" <a name="joinRoom"></a>

Source: [/server/src/commandHandlers/joinRoom.js](/server/src/commandHandlers/joinRoom.js)

Description

```text
A user joins a room.
Two scenarios:  either the room exists already or the room with the given id does not exist yet.
If the room does not yet exist, an additional "roomCreated" event is produced (as the first event).
Produces also a "roomJoined" event (which contains the room state).
Produces also events for additional properties if they are preset "usernameSet", "emailSet", "excludedFromEstimations".
For password protected rooms, we will create a Json Web Token (JWT) with an expiration date of 1 hour and pass it to the one joining user via "tokenIssued" event.
```

Produces: **[avatarSet](#avatarSet)**, **[emailSet](#emailSet)**, **[excludedFromEstimations](#excludedFromEstimations)**, **[joinedRoom](#joinedRoom)**, **[roomCreated](#roomCreated)**, **[storyAdded](#storyAdded)**, **[storySelected](#storySelected)**, **[tokenIssued](#tokenIssued)**, **[usernameSet](#usernameSet)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "username": {
                            "type": "string",
                            "format": "username"
                        },
                        "email": {
                            "type": "string",
                            "format": "email"
                        },
                        "avatar": {
                            "type": "number"
                        },
                        "password": {
                            "type": "string",
                            "minLength": 0
                        },
                        "token": {
                            "type": "string"
                        }
                    },
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "kick" <a name="kick"></a>

Source: [/server/src/commandHandlers/kick.js](/server/src/commandHandlers/kick.js)

Description

```text
A user removes a disconnected user from the room.
```

Produces: **[kicked](#kicked)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string",
                            "format": "uuidv4"
                        }
                    },
                    "required": [
                        "userId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "leaveRoom" <a name="leaveRoom"></a>

Source: [/server/src/commandHandlers/leaveRoom.js](/server/src/commandHandlers/leaveRoom.js)

Description

```text
A user wants to leave the room.
Is also produced by the socketServer itself on connection lost!
```

Produces: **[connectionLost](#connectionLost)**, **[leftRoom](#leftRoom)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "connectionLost": {
                            "type": "boolean"
                        }
                    },
                    "required": [],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "newEstimationRound" <a name="newEstimationRound"></a>

Source: [/server/src/commandHandlers/newEstimationRound.js](/server/src/commandHandlers/newEstimationRound.js)

Description

```text
A user starts a new estimation round for a certain story.
This will clear all estimations given by users for this story.
This will reset any consensus that might have been achieved previously.
Can only be done for the currently selected story.
```

Produces: **[newEstimationRoundStarted](#newEstimationRoundStarted)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "restoreStory" <a name="restoreStory"></a>

Source: [/server/src/commandHandlers/restoreStory.js](/server/src/commandHandlers/restoreStory.js)

Description

```text
A user restores a story.
A story must be first marked as "trashed", before it can be restored.
Story will no longer be marked as "trashed".
```

Produces: **[storyRestored](#storyRestored)**, **[storySelected](#storySelected)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuidv4"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "reveal" <a name="reveal"></a>

Source: [/server/src/commandHandlers/reveal.js](/server/src/commandHandlers/reveal.js)

Description

```text
A user manually reveals estimates for a certain story
Users may only reveal the currently selected story
If story is already revealed, reject command.
```

Produces: **[consensusAchieved](#consensusAchieved)**, **[revealed](#revealed)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "selectStory" <a name="selectStory"></a>

Source: [/server/src/commandHandlers/selectStory.js](/server/src/commandHandlers/selectStory.js)

Description

```text
A user selected a story (marked it as the "current" story to estimate)
```

Produces: **[storySelected](#storySelected)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setAvatar" <a name="setAvatar"></a>

Source: [/server/src/commandHandlers/setAvatar.js](/server/src/commandHandlers/setAvatar.js)

Description

```text
A user sets his avatar. Identified with a number, starting with 0.
Only the client (App) knows which and how many avatars exist and also which number maps to which avatar.
Currently 0 is the "anonymous" avatar and used by default.
```

Produces: **[avatarSet](#avatarSet)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "avatar": {
                            "type": "number"
                        }
                    },
                    "required": [
                        "avatar"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setCardConfig" <a name="setCardConfig"></a>

Source: [/server/src/commandHandlers/setCardConfig.js](/server/src/commandHandlers/setCardConfig.js)

Description

```text
A user sets a custom card configuration on the room.
```

Produces: **[cardConfigSet](#cardConfigSet)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "cardConfig": {
                            "type": "array",
                            "minItems": 0,
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": [
                                            "number",
                                            "string"
                                        ],
                                        "format": "parseableNumber"
                                    },
                                    "label": {
                                        "type": "string"
                                    },
                                    "color": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "value",
                                    "label",
                                    "color"
                                ],
                                "additionalProperties": false
                            },
                            "format": "cardConfig"
                        }
                    },
                    "required": [
                        "cardConfig"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setEmail" <a name="setEmail"></a>

Source: [/server/src/commandHandlers/setEmail.js](/server/src/commandHandlers/setEmail.js)

Description

```text
A user sets his email address (used for Gravatar image fetching. See https://en.gravatar.com/ ).
```

Produces: **[emailSet](#emailSet)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "email": {
                            "type": "string",
                            "format": "email"
                        }
                    },
                    "comment": "do not set email as required. if not set or empty string (or falsy value) will reset email",
                    "required": [],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setPassword" <a name="setPassword"></a>

Source: [/server/src/commandHandlers/setPassword.js](/server/src/commandHandlers/setPassword.js)

Description

```text
A user sets (or re-sets) a password for this room. If the password is undefined or empty, the password protection is removed (passwordCleared event).
Currently this can be done without specifying the old password.
```

Produces: **[passwordCleared](#passwordCleared)**, **[passwordSet](#passwordSet)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "password": {
                            "type": "string",
                            "minLength": 0
                        }
                    },
                    "comment": "do not set password as required. if not set or empty string (or falsy value) will reset pw -> remove pw protection from room",
                    "required": [],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setUsername" <a name="setUsername"></a>

Source: [/server/src/commandHandlers/setUsername.js](/server/src/commandHandlers/setUsername.js)

Description

```text
A user sets his username.
```

Produces: **[usernameSet](#usernameSet)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "username": {
                            "type": "string",
                            "format": "username"
                        }
                    },
                    "required": [
                        "username"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "settleEstimation" <a name="settleEstimation"></a>

Source: [/server/src/commandHandlers/settleEstimation.js](/server/src/commandHandlers/settleEstimation.js)

Description

```text
A user manually "settles" on a value for a story. (hopefully after a discussion with everybody in the room).
This will produced "consensusAchieved".
This saves the team the time to start a new round and estimate the same value.
```

Produces: **[consensusAchieved](#consensusAchieved)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        },
                        "value": {
                            "type": "number"
                        }
                    },
                    "required": [
                        "storyId",
                        "value"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "toggleAutoReveal" <a name="toggleAutoReveal"></a>

Source: [/server/src/commandHandlers/toggleAutoReveal.js](/server/src/commandHandlers/toggleAutoReveal.js)

Description

```text
A user toggles the "autoReveal" flag on the room
```

Produces: **[autoRevealOff](#autoRevealOff)**, **[autoRevealOn](#autoRevealOn)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {},
                    "required": [],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "toggleExclude" <a name="toggleExclude"></a>

Source: [/server/src/commandHandlers/toggleExclude.js](/server/src/commandHandlers/toggleExclude.js)

Description

```text
Marks a user as "Spectator" (excluded from estimations)
If user is marked as excluded, he cannot estimate stories.
As of #200, every user can "exclude" every other user -> we pass the userId in the payload of the command
```

Produces: **[excludedFromEstimations](#excludedFromEstimations)**, **[includedInEstimations](#includedInEstimations)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string",
                            "format": "uuidv4"
                        }
                    },
                    "required": [
                        "userId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "trashStory" <a name="trashStory"></a>

Source: [/server/src/commandHandlers/trashStory.js](/server/src/commandHandlers/trashStory.js)

Description

```text
A user "trashes" a story  (marked as trashed, still in room).
If the story that is "trashed" is the selectedStory in the room, an additional "storySelected" event is produced
```

Produces: **[storySelected](#storySelected)**, **[storyTrashed](#storyTrashed)**, 

<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuidv4"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>




## Events

 * [storyAdded](#storyAdded)
 * [storySelected](#storySelected)
 * [storyChanged](#storyChanged)
 * [storyEstimateCleared](#storyEstimateCleared)
 * [storyDeleted](#storyDeleted)
 * [consensusAchieved](#consensusAchieved)
 * [revealed](#revealed)
 * [storyEstimateGiven](#storyEstimateGiven)
 * [importFailed](#importFailed)
 * [avatarSet](#avatarSet)
 * [emailSet](#emailSet)
 * [excludedFromEstimations](#excludedFromEstimations)
 * [joinedRoom](#joinedRoom)
 * [roomCreated](#roomCreated)
 * [tokenIssued](#tokenIssued)
 * [usernameSet](#usernameSet)
 * [kicked](#kicked)
 * [connectionLost](#connectionLost)
 * [leftRoom](#leftRoom)
 * [newEstimationRoundStarted](#newEstimationRoundStarted)
 * [storyRestored](#storyRestored)
 * [cardConfigSet](#cardConfigSet)
 * [passwordCleared](#passwordCleared)
 * [passwordSet](#passwordSet)
 * [autoRevealOff](#autoRevealOff)
 * [autoRevealOn](#autoRevealOn)
 * [includedInEstimations](#includedInEstimations)
 * [storyTrashed](#storyTrashed)


### Event "storyAdded" <a name="storyAdded"></a>

Source: [/server/src/eventHandlers/storyAdded.js](/server/src/eventHandlers/storyAdded.js)

Produced by: **[addStory](#addStory)** **[importStories](#importStories)** **[joinRoom](#joinRoom)** 

Description

```text
a new story was added to the room
```


### Event "storySelected" <a name="storySelected"></a>

Source: [/server/src/eventHandlers/storySelected.js](/server/src/eventHandlers/storySelected.js)

Produced by: **[addStory](#addStory)** **[importStories](#importStories)** **[joinRoom](#joinRoom)** **[restoreStory](#restoreStory)** **[selectStory](#selectStory)** **[trashStory](#trashStory)** 

Description

```text
Store id of given story as "selectedStory"
```


### Event "storyChanged" <a name="storyChanged"></a>

Source: [/server/src/eventHandlers/storyChanged.js](/server/src/eventHandlers/storyChanged.js)

Produced by: **[changeStory](#changeStory)** 

Description

```text
Title and/or Description of story changed
```


### Event "storyEstimateCleared" <a name="storyEstimateCleared"></a>

Source: [/server/src/eventHandlers/storyEstimateCleared.js](/server/src/eventHandlers/storyEstimateCleared.js)

Produced by: **[clearStoryEstimate](#clearStoryEstimate)** 

Description

```text
Removes a previously set estimation value on the given story for the given user
```


### Event "storyDeleted" <a name="storyDeleted"></a>

Source: [/server/src/eventHandlers/storyDeleted.js](/server/src/eventHandlers/storyDeleted.js)

Produced by: **[deleteStory](#deleteStory)** 

Description

```text
Removes matching story from "stories" list in room
```


### Event "consensusAchieved" <a name="consensusAchieved"></a>

Source: [/server/src/eventHandlers/consensusAchieved.js](/server/src/eventHandlers/consensusAchieved.js)

Produced by: **[giveStoryEstimate](#giveStoryEstimate)** **[reveal](#reveal)** **[settleEstimation](#settleEstimation)** 

Description

```text
Stores consensus estimation value (that everybody agreed on) on story.
```


### Event "revealed" <a name="revealed"></a>

Source: [/server/src/eventHandlers/revealed.js](/server/src/eventHandlers/revealed.js)

Produced by: **[giveStoryEstimate](#giveStoryEstimate)** **[reveal](#reveal)** 

Description

```text
Estimations for the given story were revealed.
This happens automatically if all users that can estimate (not marked as excluded, not disconnected) did estimate the current story (i.e. if the last user gives his estimate)
This happens if a user manually reveals. (this is helpful, if someone is AFK and team wants to proceed with the estimation meeting)
```


### Event "storyEstimateGiven" <a name="storyEstimateGiven"></a>

Source: [/server/src/eventHandlers/storyEstimateGiven.js](/server/src/eventHandlers/storyEstimateGiven.js)

Produced by: **[giveStoryEstimate](#giveStoryEstimate)** 

Description

```text
Stores the given estimation value on the story for the given user
```


### Event "importFailed" <a name="importFailed"></a>

Source: [/server/src/eventHandlers/importFailed.js](/server/src/eventHandlers/importFailed.js)

Produced by: **[importStories](#importStories)** 

Description

```text
a stories import (csv) failed. Does not modify room in any way,
```


### Event "avatarSet" <a name="avatarSet"></a>

Source: [/server/src/eventHandlers/avatarSet.js](/server/src/eventHandlers/avatarSet.js)

Produced by: **[joinRoom](#joinRoom)** **[setAvatar](#setAvatar)** 

Description

```text
user sets his avatar (number)
```


### Event "emailSet" <a name="emailSet"></a>

Source: [/server/src/eventHandlers/emailSet.js](/server/src/eventHandlers/emailSet.js)

Produced by: **[joinRoom](#joinRoom)** **[setEmail](#setEmail)** 

Description

```text
user set his email address
```


### Event "excludedFromEstimations" <a name="excludedFromEstimations"></a>

Source: [/server/src/eventHandlers/excludedFromEstimations.js](/server/src/eventHandlers/excludedFromEstimations.js)

Produced by: **[joinRoom](#joinRoom)** **[toggleExclude](#toggleExclude)** 

Description

```text
Sets "excluded" flag on user to true.
(user is now a "spectator")
```


### Event "joinedRoom" <a name="joinedRoom"></a>

Source: [/server/src/eventHandlers/joinedRoom.js](/server/src/eventHandlers/joinedRoom.js)

Produced by: **[joinRoom](#joinRoom)** 

Description

```text
A user joined a room: update "users" array in room object.
"users" array is already correctly built in handler of joinRoom command (../commandHandlers/joinRoom.js)
```


### Event "roomCreated" <a name="roomCreated"></a>

Source: [/server/src/eventHandlers/roomCreated.js](/server/src/eventHandlers/roomCreated.js)

Produced by: **[joinRoom](#joinRoom)** 

Description

```text
A room was created. Creates a new default room object
@param room
@param eventPayload
@param userId
@param {function} modifyEventPayload
```


### Event "tokenIssued" <a name="tokenIssued"></a>

Source: [/server/src/eventHandlers/tokenIssued.js](/server/src/eventHandlers/tokenIssued.js)

Produced by: **[joinRoom](#joinRoom)** 

Description

```text
The server issued a new JWT token. this does not modify the room in any way.
```


### Event "usernameSet" <a name="usernameSet"></a>

Source: [/server/src/eventHandlers/usernameSet.js](/server/src/eventHandlers/usernameSet.js)

Produced by: **[joinRoom](#joinRoom)** **[setUsername](#setUsername)** 

Description

```text
user set his name
```


### Event "kicked" <a name="kicked"></a>

Source: [/server/src/eventHandlers/kicked.js](/server/src/eventHandlers/kicked.js)

Produced by: **[kick](#kick)** 

Description

```text
removes user from "users" list
removes estimations on all stories that were given by user
```


### Event "connectionLost" <a name="connectionLost"></a>

Source: [/server/src/eventHandlers/connectionLost.js](/server/src/eventHandlers/connectionLost.js)

Produced by: **[leaveRoom](#leaveRoom)** 

Description

```text
Marks user as "disconnected".
```


### Event "leftRoom" <a name="leftRoom"></a>

Source: [/server/src/eventHandlers/leftRoom.js](/server/src/eventHandlers/leftRoom.js)

Produced by: **[leaveRoom](#leaveRoom)** 

Description

```text
removes user from "users" list
removes estimations on all stories that were given by user
```


### Event "newEstimationRoundStarted" <a name="newEstimationRoundStarted"></a>

Source: [/server/src/eventHandlers/newEstimationRoundStarted.js](/server/src/eventHandlers/newEstimationRoundStarted.js)

Produced by: **[newEstimationRound](#newEstimationRound)** 

Description

```text
Clears all estimations on story, sets "revealed" flag to false and erases "consensus"
```


### Event "storyRestored" <a name="storyRestored"></a>

Source: [/server/src/eventHandlers/storyRestored.js](/server/src/eventHandlers/storyRestored.js)

Produced by: **[restoreStory](#restoreStory)** 

Description

```text
Resets "trashed" flag on matching story.
Flag will be "false" afterwards.
```


### Event "cardConfigSet" <a name="cardConfigSet"></a>

Source: [/server/src/eventHandlers/cardConfigSet.js](/server/src/eventHandlers/cardConfigSet.js)

Produced by: **[setCardConfig](#setCardConfig)** 

Description

```text
user did set custom cardConfig on room
```


### Event "passwordCleared" <a name="passwordCleared"></a>

Source: [/server/src/eventHandlers/passwordCleared.js](/server/src/eventHandlers/passwordCleared.js)

Produced by: **[setPassword](#setPassword)** 

Description

```text
user removed password protection from room
```


### Event "passwordSet" <a name="passwordSet"></a>

Source: [/server/src/eventHandlers/passwordSet.js](/server/src/eventHandlers/passwordSet.js)

Produced by: **[setPassword](#setPassword)** 

Description

```text
user did set new password for room
```


### Event "autoRevealOff" <a name="autoRevealOff"></a>

Source: [/server/src/eventHandlers/autoRevealOff.js](/server/src/eventHandlers/autoRevealOff.js)

Produced by: **[toggleAutoReveal](#toggleAutoReveal)** 

Description

```text
Sets "autoReveal" flag on room to false
```


### Event "autoRevealOn" <a name="autoRevealOn"></a>

Source: [/server/src/eventHandlers/autoRevealOn.js](/server/src/eventHandlers/autoRevealOn.js)

Produced by: **[toggleAutoReveal](#toggleAutoReveal)** 

Description

```text
Sets "autoReveal" flag on room to true
```


### Event "includedInEstimations" <a name="includedInEstimations"></a>

Source: [/server/src/eventHandlers/includedInEstimations.js](/server/src/eventHandlers/includedInEstimations.js)

Produced by: **[toggleExclude](#toggleExclude)** 

Description

```text
Sets "excluded" flag on user to false.
(user is no longer "spectator")
```


### Event "storyTrashed" <a name="storyTrashed"></a>

Source: [/server/src/eventHandlers/storyTrashed.js](/server/src/eventHandlers/storyTrashed.js)

Produced by: **[trashStory](#trashStory)** 

Description

```text
Marks matching story as "trashed".  Story stays in room.
```



